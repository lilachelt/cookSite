
<!DOCTYPE html>
<html>
<head>
    <title>{{title}}</title>
    <link rel="stylesheet" href="stylesheets/noResult.css">
    <script type="application/javascript" src="js/jquery-1.12.4.min.js"></script>
</head>
<body >

<div id="container">
    <form action="" id="theForm" method="post">

        <div id="logo_searchline_wrapper">
            <div>
                <a href ="http://www.cookit.co.il/" > <img id="logo" src="images\logo.jpg"> </a>
            </div>
            <!--{{searchString}}-->
            <div id="myProgressBar">
                <div id="myBar">
                </div>
            </div>
            <div id="noResults" type="hidden">
              <!--<p > Sorry,we have no results for you</p>-->
            </div>
            <div class="inline_display">
                <input type="hidden" id="isContinueSearch" name="isContinueSearch" value="{{isContinueSearch}}" />
                <input type="hidden" id="searchLine" name="search" value="{{searchString}}" />
            </div>
            <div id = "endSearch"> </div>
        </div>
    </form>
 </div>

<script>
    var stopTimeOut = setTimeout(doSearch, 100);
    var retries = 0;
    function doSearch() {

        clearTimeout(stopTimeOut);
        if (document.getElementById("isContinueSearch").value == "yes") {
            var postData = $('#theForm').serialize();
            var formURL = $('#theForm').attr("action");
            $.ajax(
                    {
                        url: formURL,
                        type: "POST",
                        data: postData,
                        success: function (data, textStatus, jqXHR) {
                            if (data.isSuccess == "false")
                            {
                                retries++;
                                if (retries == 2)
                                {
                                    console.log("no results");
                                    //TODO show index page (before showing no result)
                                    // Not success
                                    $("#myBar").hide();
                                    ///MOR NEW
//                                    $("#searchLine").show();
                                    $("#endSearch").append("NO RESULT ");
                                    setTimeout(function(){
                                        window.location = '/';
                                    }, 2000);




                                }
                                else {
                                    $("#myBar").load (move());
                                    stopTimeOut = setTimeout(doSearch, 10000);
                                }
                            }
                            else
                            {
                                document.open();
                                document.write(data);
                                document.close();
                            }
                            //data: return data from server
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            $("#myBar").append("total fail ");
                            //if fails
                        }
                    });
        }
    }
</script>


<script>
    function move() {
        var elem = document.getElementById("myBar");
        var width = 1;
        var id = setInterval(frame, 1000);
        function frame() {
            if (width >= 100) {
                clearInterval(id);
            } else {
                width++;
                elem.style.width = width + '%';
            }
        }
    }
</script>




</body>
</html>